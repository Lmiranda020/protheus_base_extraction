import psutil

def fechar_aplicativo_protheus(nome_processo="web-agent-windows-x64.exe"):
    """
    Fecha o aplicativo ao final da automa√ß√£o
    """
    print(f"\nüîö Fechando aplicativo {nome_processo}...")
    try:
        for proc in psutil.process_iter(['name']):
            if proc.info['name'] == nome_processo:
                proc.kill()
                print(f"‚úÖ Aplicativo fechado (PID: {proc.pid})")
                return True
        print("‚ö†Ô∏è Aplicativo n√£o encontrado rodando")
        return False
    except Exception as e:
        print(f"‚ùå Erro ao fechar aplicativo: {e}")
        return False